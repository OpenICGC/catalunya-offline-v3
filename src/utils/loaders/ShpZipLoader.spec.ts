import {expect} from 'chai';
import ShpZipLoader from './ShpZipLoader';

import sampleShpZip from './fixtures/sample-shp.zip';
import sampleNoShpZip from './fixtures/sample-no-shp.zip';
import sampleShp25831Zip from './fixtures/sample-shp-25831.zip';
import GeoJSON from 'geojson';

const expectedResult = {
  type: 'FeatureCollection',
  features: [{
    type: 'Feature',
    geometry: {
      type: 'Polygon',
      coordinates: [[[2.3727,42.1723],[2.37574,42.16951],[2.3788,42.17092],[2.38599,42.16687],[2.38447,42.1635],[2.38176,42.16271],[2.37784,42.16441],[2.37444,42.16324],[2.37179,42.16135],[2.36372,42.1604],[2.35789,42.15696],[2.35776,42.15595],[2.35743,42.15428],[2.35732,42.15387],[2.35705,42.15371],[2.35399,42.1519],[2.35182,42.15069],[2.35103,42.15052],[2.35087,42.15049],[2.35068,42.15023],[2.35057,42.15008],[2.34924,42.14768],[2.34877,42.14417],[2.34878,42.14386],[2.35077,42.13767],[2.35538,42.13493],[2.36722,42.12978],[2.3743,42.12888],[2.38106,42.12368],[2.37818,42.12122],[2.3769,42.12016],[2.3755,42.11904],[2.37446,42.11772],[2.37405,42.1169],[2.37392,42.11655],[2.37349,42.11633],[2.37337,42.11626],[2.37332,42.11621],[2.37321,42.11594],[2.37318,42.11582],[2.37317,42.1157],[2.37318,42.11561],[2.37393,42.11311],[2.37658,42.10546],[2.37975,42.10365],[2.3799,42.10359],[2.37999,42.10358],[2.38027,42.10357],[2.38164,42.10354],[2.3818,42.10355],[2.38457,42.10384],[2.38567,42.10403],[2.3858,42.10407],[2.38594,42.10409],[2.38658,42.1042],[2.38705,42.10423],[2.38751,42.10424],[2.38862,42.10426],[2.39475,42.10424],[2.39916,42.10328],[2.39926,42.10323],[2.40017,42.10276],[2.40021,42.10271],[2.39464,42.0953],[2.39412,42.09165],[2.39602,42.08914],[2.39623,42.08907],[2.39636,42.08895],[2.39648,42.0887],[2.39656,42.08849],[2.39688,42.08761],[2.3945,42.08676],[2.39975,42.08216],[2.40344,42.0798],[2.40725,42.07377],[2.41132,42.06881],[2.416,42.06685],[2.42687,42.06128],[2.42809,42.06173],[2.42947,42.06432],[2.43479,42.06798],[2.43914,42.07002],[2.44988,42.07587],[2.45471,42.07803],[2.45821,42.07912],[2.46263,42.07711],[2.46278,42.07702],[2.4666,42.07434],[2.46685,42.07413],[2.46688,42.07394],[2.47646,42.07621],[2.47886,42.0752],[2.47996,42.07433],[2.48172,42.07052],[2.48344,42.06759],[2.48656,42.069],[2.48712,42.06906],[2.48765,42.06899],[2.48999,42.06866],[2.49055,42.06841],[2.49073,42.06827],[2.49092,42.06808],[2.49491,42.06151],[2.49614,42.05901],[2.49281,42.05824],[2.48668,42.05467],[2.48195,42.05168],[2.48138,42.05105],[2.48131,42.05093],[2.48128,42.05084],[2.48128,42.05074],[2.48134,42.05064],[2.48421,42.04684],[2.4879,42.04503],[2.48868,42.04454],[2.48938,42.04359],[2.48961,42.04325],[2.4928,42.03834],[2.49962,42.03365],[2.50317,42.03216],[2.50594,42.03233],[2.50609,42.0323],[2.50582,42.03094],[2.50579,42.03079],[2.50508,42.02824],[2.50481,42.02739],[2.50406,42.02551],[2.50385,42.02502],[2.50356,42.02435],[2.50306,42.0235],[2.49857,42.02116],[2.49779,42.02094],[2.49714,42.02091],[2.4961,42.02093],[2.49467,42.01744],[2.49508,42.01368],[2.49813,42.01093],[2.49981,42.00787],[2.49905,42.0015],[2.49297,42.00128],[2.48818,41.99899],[2.48322,41.99714],[2.47973,41.99945],[2.47666,41.99735],[2.47414,41.996],[2.46881,41.99374],[2.48055,41.98862],[2.48802,41.98485],[2.48005,41.98249],[2.48021,41.97873],[2.4757,41.97751],[2.4727,41.97535],[2.47169,41.97241],[2.47162,41.96919],[2.46799,41.96812],[2.45828,41.96644],[2.45225,41.96589],[2.4497,41.96919],[2.44956,41.9694],[2.44933,41.96976],[2.44934,41.96989],[2.44134,41.96806],[2.44204,41.96947],[2.44215,41.96967],[2.44247,41.96994],[2.44257,41.96998],[2.44281,41.97011],[2.44289,41.97073],[2.44287,41.97089],[2.44276,41.97161],[2.44192,41.97245],[2.4417,41.97265],[2.44151,41.97279],[2.44134,41.97289],[2.44076,41.97308],[2.44053,41.97314],[2.43917,41.97339],[2.43827,41.97339],[2.43543,41.97298],[2.4343,41.97281],[2.43414,41.97278],[2.43378,41.97268],[2.43344,41.97256],[2.43324,41.97245],[2.42728,41.96895],[2.42727,41.96871],[2.42905,41.96569],[2.4348,41.96408],[2.43949,41.96315],[2.44144,41.95991],[2.44179,41.95823],[2.44214,41.95657],[2.44211,41.95449],[2.43813,41.95142],[2.43676,41.94797],[2.44037,41.94342],[2.44238,41.94143],[2.44399,41.94159],[2.44425,41.94163],[2.44466,41.94172],[2.44479,41.94176],[2.44491,41.94183],[2.4571,41.94345],[2.4621,41.9403],[2.47018,41.93914],[2.47172,41.93809],[2.4791,41.93084],[2.47951,41.93026],[2.4797,41.92992],[2.47983,41.92963],[2.47996,41.92924],[2.48005,41.9287],[2.48003,41.92845],[2.47968,41.92171],[2.47895,41.91624],[2.47707,41.91579],[2.47653,41.91565],[2.47632,41.91556],[2.47536,41.91514],[2.47493,41.9149],[2.47487,41.91486],[2.47482,41.91481],[2.47123,41.9091],[2.46857,41.90483],[2.46814,41.90423],[2.46641,41.90347],[2.46021,41.9012],[2.45909,41.8984],[2.45668,41.89683],[2.45651,41.89674],[2.45543,41.89617],[2.455,41.89596],[2.45409,41.89573],[2.45373,41.89569],[2.4535,41.89572],[2.45295,41.89588],[2.45248,41.8959],[2.44889,41.89565],[2.44852,41.8956],[2.44749,41.8954],[2.44701,41.89528],[2.44667,41.89517],[2.44651,41.89507],[2.44619,41.89476],[2.44598,41.89442],[2.44575,41.89402],[2.44565,41.89377],[2.44566,41.8936],[2.44583,41.89328],[2.44591,41.89316],[2.44636,41.89189],[2.44625,41.89026],[2.44618,41.89014],[2.4457,41.88959],[2.4456,41.88949],[2.44549,41.8894],[2.44525,41.88927],[2.44316,41.88824],[2.44369,41.88573],[2.44376,41.88548],[2.44391,41.88521],[2.44395,41.88515],[2.44404,41.88503],[2.44424,41.88485],[2.44477,41.88439],[2.44492,41.88427],[2.44501,41.88422],[2.44567,41.88397],[2.44618,41.88377],[2.4517,41.88112],[2.45179,41.88104],[2.45233,41.8805],[2.45297,41.87963],[2.45302,41.87951],[2.45309,41.87936],[2.45312,41.87926],[2.45314,41.87915],[2.45318,41.87889],[2.4532,41.87876],[2.45375,41.86966],[2.44615,41.85981],[2.44261,41.8607],[2.44103,41.86023],[2.43918,41.85809],[2.43903,41.85744],[2.43887,41.85658],[2.43843,41.85522],[2.43836,41.85504],[2.43826,41.85494],[2.43283,41.85311],[2.43133,41.85331],[2.43079,41.85341],[2.42956,41.8537],[2.42906,41.85395],[2.4267,41.8546],[2.42257,41.85471],[2.41812,41.85068],[2.41801,41.84966],[2.42248,41.84275],[2.42414,41.84005],[2.42425,41.83973],[2.42426,41.83947],[2.42336,41.83731],[2.42316,41.83712],[2.42127,41.83646],[2.41694,41.83468],[2.41327,41.83176],[2.41171,41.83039],[2.40759,41.82365],[2.40752,41.82351],[2.40739,41.82307],[2.40742,41.82267],[2.40744,41.82257],[2.4082,41.82064],[2.41008,41.81721],[2.41461,41.80925],[2.4168,41.80602],[2.41841,41.8045],[2.41622,41.80463],[2.412,41.80327],[2.41196,41.80314],[2.4119,41.80304],[2.41161,41.80278],[2.4111,41.80231],[2.41091,41.80216],[2.41066,41.80196],[2.41053,41.80189],[2.41041,41.80184],[2.40998,41.80169],[2.40989,41.80166],[2.40978,41.80165],[2.40548,41.80167],[2.40537,41.80167],[2.40498,41.80169],[2.40473,41.8017],[2.40449,41.80174],[2.40432,41.80179],[2.40412,41.80185],[2.40395,41.80192],[2.403,41.80232],[2.39946,41.80382],[2.39728,41.80505],[2.39149,41.80546],[2.38698,41.80519],[2.38268,41.8088],[2.38037,41.80484],[2.38029,41.80463],[2.38024,41.80443],[2.38019,41.80408],[2.38018,41.80393],[2.38019,41.80376],[2.37866,41.80125],[2.37563,41.79693],[2.36987,41.79414],[2.36979,41.79415],[2.36972,41.79415],[2.36965,41.79415],[2.36958,41.79414],[2.36829,41.79392],[2.3642,41.79196],[2.36313,41.7911],[2.36222,41.78988],[2.36547,41.78547],[2.36607,41.77979],[2.36586,41.77127],[2.36572,41.77058],[2.36569,41.77042],[2.36562,41.77014],[2.36556,41.77001],[2.36548,41.7699],[2.36536,41.76976],[2.36519,41.76959],[2.36339,41.76833],[2.36213,41.7678],[2.35705,41.76615],[2.34893,41.76416],[2.34353,41.76329],[2.34125,41.7632],[2.33959,41.76395],[2.33436,41.76365],[2.33291,41.76717],[2.33231,41.77186],[2.32847,41.77575],[2.32964,41.77868],[2.32819,41.78879],[2.3209,41.78783],[2.31704,41.79263],[2.30511,41.79798],[2.30368,41.79851],[2.29874,41.79736],[2.29826,41.79714],[2.29773,41.79686],[2.29548,41.79565],[2.29395,41.79475],[2.29153,41.79322],[2.29074,41.79256],[2.28924,41.79023],[2.28901,41.78936],[2.289,41.78929],[2.28902,41.7892],[2.28906,41.78914],[2.28917,41.78903],[2.28118,41.79128],[2.27755,41.7924],[2.27055,41.79535],[2.26777,41.79796],[2.26739,41.80427],[2.26704,41.80339],[2.26427,41.79737],[2.26387,41.79669],[2.26262,41.79584],[2.26089,41.79483],[2.25952,41.79404],[2.25324,41.78794],[2.24969,41.78443],[2.24736,41.78213],[2.24594,41.7816],[2.24584,41.78157],[2.24575,41.78152],[2.24567,41.78147],[2.24558,41.78142],[2.24544,41.78133],[2.24534,41.78124],[2.24526,41.78116],[2.2452,41.78108],[2.24522,41.78081],[2.24523,41.78071],[2.24525,41.78059],[2.24528,41.7805],[2.24546,41.77994],[2.2459,41.77857],[2.24615,41.77798],[2.2466,41.77705],[2.24686,41.77573],[2.24693,41.77488],[2.24677,41.77298],[2.24669,41.77251],[2.24625,41.77037],[2.24732,41.76961],[2.25067,41.76677],[2.25183,41.7654],[2.25208,41.76492],[2.25177,41.76286],[2.24983,41.75962],[2.24933,41.75815],[2.24946,41.75573],[2.25055,41.7499],[2.25064,41.74962],[2.25079,41.74938],[2.25101,41.74919],[2.25176,41.74883],[2.25292,41.74855],[2.25349,41.74854],[2.25479,41.74865],[2.25731,41.74789],[2.25767,41.74776],[2.25832,41.74745],[2.25954,41.74665],[2.2604,41.74548],[2.26048,41.74537],[2.26052,41.74526],[2.26069,41.74474],[2.26073,41.74461],[2.26078,41.74427],[2.26078,41.74418],[2.26059,41.74066],[2.25793,41.73818],[2.25968,41.73541],[2.26045,41.73539],[2.26201,41.73536],[2.26221,41.73527],[2.26229,41.73523],[2.26231,41.73521],[2.26236,41.73515],[2.26236,41.73513],[2.26273,41.73229],[2.26235,41.73064],[2.25785,41.72868],[2.2565,41.72822],[2.25644,41.72821],[2.25634,41.7282],[2.25615,41.72819],[2.2559,41.7282],[2.25532,41.73077],[2.24385,41.7302],[2.24058,41.72961],[2.23617,41.73207],[2.22821,41.72954],[2.22364,41.72972],[2.21897,41.72858],[2.21357,41.72688],[2.20218,41.72883],[2.19327,41.73063],[2.18951,41.73255],[2.18447,41.74267],[2.18745,41.74994],[2.18863,41.75561],[2.18847,41.75715],[2.18816,41.76616],[2.18835,41.77073],[2.18876,41.77528],[2.18623,41.78207],[2.18563,41.78671],[2.18601,41.78918],[2.18347,41.79361],[2.17837,41.79585],[2.17562,41.79825],[2.17822,41.80001],[2.17978,41.8018],[2.18553,41.80909],[2.1879,41.81475],[2.19177,41.82095],[2.19432,41.82948],[2.19436,41.82974],[2.19437,41.83143],[2.19653,41.8361],[2.19337,41.83861],[2.19197,41.83793],[2.18848,41.84412],[2.18963,41.84671],[2.18979,41.84735],[2.18996,41.84808],[2.18997,41.84814],[2.18997,41.84835],[2.18996,41.84861],[2.18994,41.84876],[2.18982,41.84938],[2.18631,41.8599],[2.18422,41.85695],[2.18422,41.85601],[2.18422,41.8559],[2.18422,41.85583],[2.1842,41.85578],[2.18401,41.85531],[2.1839,41.8551],[2.1838,41.85491],[2.18362,41.85468],[2.18338,41.8545],[2.17992,41.85263],[2.1797,41.85258],[2.17826,41.85245],[2.17788,41.85242],[2.17746,41.8524],[2.17702,41.85248],[2.17003,41.85485],[2.16823,41.85549],[2.16702,41.8557],[2.16142,41.85618],[2.15782,41.85645],[2.15681,41.85622],[2.15523,41.85489],[2.15429,41.8539],[2.15395,41.85347],[2.1462,41.8526],[2.14528,41.85328],[2.14373,41.85444],[2.14313,41.85489],[2.13671,41.85887],[2.13634,41.85939],[2.13604,41.85999],[2.13578,41.86052],[2.13557,41.86093],[2.13525,41.86278],[2.13498,41.86301],[2.13061,41.86669],[2.1285,41.86902],[2.12885,41.8708],[2.13013,41.87212],[2.13069,41.87244],[2.13135,41.87318],[2.13161,41.87359],[2.13168,41.87372],[2.13174,41.87382],[2.13181,41.87396],[2.13186,41.8741],[2.13197,41.87455],[2.13198,41.87464],[2.13196,41.87761],[2.13188,41.87821],[2.1316,41.87861],[2.13099,41.87939],[2.13094,41.87943],[2.13064,41.87959],[2.12403,41.88106],[2.123,41.88563],[2.13304,41.88637],[2.13819,41.88937],[2.1399,41.89189],[2.14115,41.89888],[2.14206,41.90009],[2.14395,41.90171],[2.14355,41.90218],[2.14203,41.90404],[2.1407,41.90582],[2.13985,41.9071],[2.13927,41.9084],[2.13924,41.90847],[2.13922,41.90853],[2.1392,41.90858],[2.13919,41.90867],[2.13918,41.90876],[2.13917,41.90886],[2.13905,41.9102],[2.13918,41.91035],[2.13702,41.91332],[2.13524,41.91333],[2.13017,41.91005],[2.12002,41.90776],[2.11484,41.90687],[2.11265,41.90628],[2.11125,41.90571],[2.10828,41.90436],[2.10485,41.90333],[2.09612,41.90367],[2.09167,41.90457],[2.09127,41.909],[2.0934,41.91386],[2.09307,41.91389],[2.09283,41.9139],[2.09163,41.91423],[2.0904,41.91478],[2.09038,41.91505],[2.09812,41.92136],[2.10121,41.92002],[2.10554,41.92343],[2.10684,41.92449],[2.1117,41.92889],[2.11223,41.92938],[2.11352,41.93079],[2.11404,41.93247],[2.11479,41.93438],[2.11558,41.93574],[2.12071,41.94216],[2.1229,41.94415],[2.12801,41.94268],[2.1396,41.94462],[2.13934,41.94462],[2.13925,41.94467],[2.13918,41.94472],[2.13909,41.94477],[2.139,41.94486],[2.1384,41.94541],[2.1369,41.94722],[2.13658,41.94777],[2.13648,41.94796],[2.13645,41.94804],[2.13631,41.94883],[2.13608,41.95117],[2.13577,41.9547],[2.13577,41.95519],[2.13369,41.95678],[2.13149,41.95655],[2.12871,41.9579],[2.12849,41.96133],[2.13119,41.96444],[2.12149,41.96671],[2.12829,41.9719],[2.12737,41.97764],[2.12733,41.97858],[2.12767,41.97882],[2.12853,41.98142],[2.12907,41.98503],[2.12769,41.98739],[2.1271,41.98849],[2.12436,41.99084],[2.13301,42.00051],[2.1348,42.00195],[2.13985,42.0036],[2.1417,42.00706],[2.14665,42.01046],[2.15475,42.01101],[2.15536,42.00954],[2.16884,42.00615],[2.17343,42.00334],[2.17375,42.00314],[2.17404,42.00299],[2.17577,42.00281],[2.17699,42.00315],[2.17861,42.0038],[2.18,42.00465],[2.18383,42.0051],[2.1876,42.0074],[2.1892,42.0079],[2.18999,42.00749],[2.19007,42.00745],[2.19017,42.00745],[2.19335,42.008],[2.19371,42.00976],[2.19308,42.01188],[2.19317,42.01423],[2.19329,42.01446],[2.19346,42.01463],[2.19724,42.01528],[2.20003,42.01826],[2.19693,42.02564],[2.19127,42.03001],[2.18765,42.03309],[2.18054,42.04195],[2.17485,42.03961],[2.16507,42.03768],[2.15112,42.03227],[2.15032,42.03164],[2.14628,42.02908],[2.14024,42.02635],[2.13635,42.02529],[2.13175,42.0255],[2.12396,42.03284],[2.1243,42.03329],[2.12476,42.03369],[2.12683,42.03532],[2.12898,42.04158],[2.12811,42.04211],[2.12794,42.04223],[2.1266,42.04327],[2.1265,42.04336],[2.1264,42.04345],[2.12632,42.04353],[2.1262,42.04371],[2.12592,42.04414],[2.12467,42.04705],[2.12395,42.04912],[2.12391,42.04926],[2.12411,42.04951],[2.12426,42.04966],[2.1253,42.0508],[2.12538,42.05089],[2.1255,42.05099],[2.12588,42.05129],[2.12598,42.05135],[2.12608,42.0514],[2.12732,42.05183],[2.13584,42.05188],[2.13513,42.05288],[2.13446,42.05355],[2.13416,42.05409],[2.13553,42.05754],[2.12766,42.06214],[2.12439,42.06479],[2.12001,42.07003],[2.11607,42.07241],[2.11065,42.07582],[2.10899,42.07739],[2.10813,42.07833],[2.10744,42.08136],[2.106,42.08345],[2.10539,42.08443],[2.10507,42.08545],[2.10891,42.09076],[2.11262,42.09844],[2.11241,42.09987],[2.11605,42.10182],[2.12158,42.10007],[2.12263,42.09919],[2.12702,42.09981],[2.13004,42.10043],[2.13008,42.10062],[2.13009,42.10064],[2.13009,42.10066],[2.13008,42.1007],[2.12995,42.10104],[2.12972,42.10158],[2.13293,42.10524],[2.12788,42.1084],[2.12585,42.11241],[2.12774,42.11491],[2.13734,42.12078],[2.13971,42.12585],[2.14357,42.13092],[2.1634,42.13498],[2.18092,42.13525],[2.18648,42.13398],[2.18787,42.1313],[2.18615,42.12832],[2.18873,42.12429],[2.19217,42.12397],[2.20053,42.12397],[2.20149,42.12431],[2.20413,42.12525],[2.20444,42.12549],[2.20415,42.12566],[2.2037,42.12592],[2.20322,42.12624],[2.2029,42.12647],[2.20262,42.12671],[2.20244,42.12696],[2.20223,42.1273],[2.20206,42.1276],[2.20181,42.12821],[2.20176,42.12855],[2.20177,42.12891],[2.20178,42.12916],[2.20181,42.12955],[2.20189,42.12978],[2.20209,42.13013],[2.2023,42.13041],[2.20289,42.13096],[2.20326,42.13121],[2.20347,42.13134],[2.20372,42.13146],[2.20404,42.13155],[2.20443,42.1316],[2.20481,42.13159],[2.20516,42.13152],[2.20538,42.13144],[2.20558,42.13133],[2.20597,42.13104],[2.20625,42.13083],[2.20643,42.13064],[2.2066,42.1303],[2.20681,42.12989],[2.20697,42.12959],[2.2071,42.12938],[2.20765,42.12859],[2.20843,42.12753],[2.2085,42.12744],[2.20862,42.12733],[2.20878,42.12727],[2.20896,42.12722],[2.20926,42.12717],[2.20945,42.12718],[2.21093,42.12734],[2.21123,42.12739],[2.21133,42.12745],[2.21169,42.12776],[2.21298,42.1289],[2.20984,42.13109],[2.20743,42.13482],[2.20805,42.1351],[2.20859,42.13536],[2.20929,42.13572],[2.20953,42.13585],[2.21051,42.13646],[2.21086,42.13674],[2.21091,42.13682],[2.21105,42.13713],[2.21106,42.13729],[2.21102,42.13742],[2.21071,42.13831],[2.20988,42.13959],[2.21127,42.13931],[2.21429,42.1394],[2.22234,42.1422],[2.23493,42.14366],[2.23599,42.14378],[2.23753,42.14375],[2.24011,42.14281],[2.2413,42.14099],[2.24163,42.14016],[2.24472,42.13862],[2.25861,42.13912],[2.26289,42.14157],[2.26971,42.14494],[2.26987,42.14501],[2.27147,42.14371],[2.27283,42.14201],[2.27281,42.14127],[2.27243,42.14042],[2.27542,42.14013],[2.27963,42.1405],[2.28121,42.14067],[2.28174,42.14055],[2.28253,42.14039],[2.28538,42.14004],[2.28558,42.14003],[2.28576,42.14005],[2.28592,42.14008],[2.28674,42.1407],[2.2876,42.1414],[2.28843,42.14217],[2.29475,42.14929],[2.2896,42.1492],[2.28817,42.14906],[2.28292,42.14923],[2.27865,42.1497],[2.27755,42.14991],[2.27959,42.15068],[2.283,42.15144],[2.28373,42.15166],[2.28566,42.15237],[2.28654,42.15282],[2.2888,42.15407],[2.28907,42.15428],[2.29108,42.15673],[2.28805,42.15641],[2.28548,42.15671],[2.28195,42.15713],[2.27773,42.15876],[2.27707,42.1617],[2.26957,42.16247],[2.26936,42.16236],[2.26909,42.16225],[2.26837,42.16209],[2.26826,42.16208],[2.26794,42.16214],[2.26762,42.1622],[2.26745,42.16226],[2.26726,42.16236],[2.26489,42.16418],[2.26931,42.16363],[2.27099,42.16375],[2.27683,42.16438],[2.28793,42.16418],[2.2907,42.16562],[2.2958,42.16569],[2.29795,42.16516],[2.30133,42.1618],[2.3039,42.15908],[2.31122,42.16063],[2.31861,42.1628],[2.32309,42.16213],[2.32722,42.16256],[2.33053,42.16394],[2.33583,42.16615],[2.34269,42.16893],[2.35628,42.17137],[2.3612,42.17151],[2.37117,42.1761],[2.3727,42.1723]]]
    },
    properties: {CODICOMAR: '24',NOMCOMAR: 'Osona', CAPCOMAR: 'Vic'}
  }]
};

const matchCoords = (coordinates: GeoJSON.Position[][], delta: number) => {
  const expected = expectedResult.features[0].geometry.coordinates;
  coordinates.map((ring, r) => ring.map((position, i) => {
    expect(position[0]).to.be.closeTo(expected[r][i][0], delta);
    expect(position[1]).to.be.closeTo(expected[r][i][1], delta);
  }));
};

describe.only('ShpZipLoader', () => {

  it('should import a zip-compressed Shapefile from a url', async () => {
    // WHEN
    const result = await ShpZipLoader.load(sampleShpZip);

    // THEN
    expect(result).to.deep.equal(expectedResult);
  });

  it('should error if zip doesn\'t contain shp and dbf files', async () => {
    // WHEN
    try {
      await ShpZipLoader.load(sampleNoShpZip);
    } catch (err) {
      // THEN
      expect((err as Error).message).to.deep.equal('No .shp or .dbf files found in zip');
    }
  });

  it('should reproject geometries if a prj file other than WGS84 exists', async () => {
    // WHEN
    try {
      const result = await ShpZipLoader.load(sampleShp25831Zip);
      // THEN
      matchCoords((result.features[0].geometry as GeoJSON.Polygon).coordinates, 1e-8);
    } catch (err) {
      // THEN
      console.error(err);
    }
  });

});
